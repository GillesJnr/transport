{% extends 'transport/demo/layout.html' %}
{% block customcss %}
<style type="text/css">
.custom{
min-width: 50px;
left:-149px !important;
right: 0;
}

#text-reverse{
    font-size: 14px !important;
    font-weight: normal !important;
    white-space:pre-line !important;
}
</style>
{% endblock %}

{% block content %}
    <div class="row mdc-layout-grid__cell">
        <div class="col-12 col-md-12">
          <div class="box box-primary">
                <div class="box-header with-border container">
                    <h3 style="float:left" class="box-title float-left">Manage Service Reminders</h3>
                    <a href="#" class="btn btn-primary btn-sm float-right">Add Service Reminder</a>
                    <a href="#" class="btn btn-success btn-sm float-right mr-2">Add Service Item</a>
                  </div>
        </div>
      </div>
       

  <div class="col-12 col-md-12">
  <div class="mdc-layout-grid__cell stretch-card mdc-layout-grid__cell--span-12" style="margin-left:30px;">
    <div class="mdc-card p-0">
      <!-- <h6 class="card-title card-padding pb-0">Hoverable Table</h6> -->
      <div class="table-responsive">
        <table class="table table-hoverable">
          <thead>
            <tr>
              <th class="text-left align-middle table-font-change">Vehicle</th>
              <th class="text-left align-middle table-font-change"></th>
              <th class="text-left align-middle table-font-change">Service Item</th>
              <th class="text-left align-middle table-font-change">Last performed</th>
              <th class="text-left align-middle table-font-change">Next Due (Date)</th>
              <th class="text-left align-middle table-font-change">Next Due (Meter)</th>
              <th class="text-left align-middle table-font-change">Action</th>
            </tr>
          </thead>

          <tbody>
            {% for row in data %}
            {% for time in time_list %}
            <tr>
              <td class="text-left align-middle"><img style="height: 70px; width: 70px;" class="image-responsive" src="media/{{ row.vehicle_id.vehicle_image }}"></td>
              <td id="text-reverse" style="white-space:pre-line !important;" class="text-left align-middle table-font-change">{{ row.vehicle_id.year }} {{row.vehicle_id.make}} - {{row.vehicle_id.model}} <br> <strong>VIN</strong>: {{row.vehicle_id.vin}} <strong>Plate</strong>: {{ row.vehicle_id.license_plate }}</td>
              <td id="text-reverse" class="text-left align-middle table-font-change">{{ row.service_id.description}} <br> Interval: {{row.service_id.overdue_time }} {{row.service_id.overdue_unit }}</td>
              <td id="text-reverse" class="text-left align-middle table-font-change">Date: {{row.last_date }} <br> Meter: {{row.last_meter}} </td>
              <td id="text-reverse" class="text-left align-middle table-font-change">{{ time }} <br> After: {{row.service_id.overdue_time }} {{row.service_id.overdue_unit }}</td>
              <td id="text-reverse" class="text-left align-middle table-font-change">{{ row.service_id.duesoon_meter }} km</td>
              <td class="text-left align-middle table-font-change">
                <div class="btn-group">

                  <button type="button" class="btn btn-danger align-middle" data-toggle="dropdown">
                    <i class="fa fa-trash" aria-hidden="true"><a href="javascript:document.form_{{row.id}}.submit();"></a></i>
                  </button>

                </div>
              </td>
            </tr>
            {% endfor %}
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>
  </div>


  </tbody>
  </table>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block script %}

<script type="text/javascript">

$("#del_btn").on("click",function(){
    var id=$(this).data("submit");
    $("#form_"+id).submit();
  });
   $('#myModal').on('show.bs.modal', function(e) {
  var id = e.relatedTarget.dataset.id;
  $("#del_btn").attr("data-submit",id);
    });

   $('#changepass').on('show.bs.modal', function(e) {
  var id = e.relatedTarget.dataset.id;

  $("#driver_id").val(id);
    });

   $("#changepass_form").on("submit",function(e){
    $.ajax({
      type: "POST",
      url: $(this).attr("action"),
      data: $(this).serialize(),
      success: function(data){

       new PNotify({
            title: 'Success!',
            text: 'Password Has Been Changed',
            type: 'info'
        });
      },

      dataType: "html"
    });
    $('#changepass').modal("hide");
e.preventDefault();
});
</script>
{% endblock %}